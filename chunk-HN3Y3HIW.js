import{b as he,d as fe,e as Ie,f as Ce}from"./chunk-CPF7GBLB.js";import{a as _e}from"./chunk-HNO7T43E.js";import{$ as P,A as $,B as ee,C as te,K as ne,L as ie,M as oe,N as ae,O as re,P as se,Q as le,S as ce,T as x,U as me,V as v,W as b,X as S,Y as T,Z as y,_ as A,aa as D,b as Y,ba as de,c as d,ca as pe,d as p,da as ue,e as l,f as Z,fa as ge,g as J,ga as O,h as K,ha as k,i as M,ia as E,j as g,ja as N,k as r,ka as V,l as s,m as _,ma as W,n as w,na as F,o as u,oa as L,p as c,pa as B,q as m,qa as R,s as H,t as Q,u as h,v as f,w as I,x as z,y as G,z as X}from"./chunk-77G7PXLM.js";import"./chunk-DUYHUZ4S.js";import"./chunk-7KGURMOZ.js";import"./chunk-2BDPOVPE.js";import"./chunk-675DDOZA.js";import"./chunk-EXZR7M25.js";import"./chunk-G3CV3VGG.js";import"./chunk-JX3TYZ34.js";import"./chunk-RUY5SX76.js";import"./chunk-NIOQNOHM.js";import"./chunk-4U6PRYVA.js";import"./chunk-BTS5SJXR.js";import"./chunk-JWIEPCRG.js";import"./chunk-QPVVTFFW.js";import"./chunk-J6ICYO4L.js";import"./chunk-LF5XB4YN.js";import"./chunk-RW4GY4BD.js";var j,ve=function(){if(typeof window>"u")return new Map;if(!j){var t=window;t.Ionicons=t.Ionicons||{},j=t.Ionicons.map=t.Ionicons.map||new Map}return j},q=function(t){Object.keys(t).forEach(function(i){Me(i,t[i]);var o=i.replace(/([a-z0-9]|(?=[A-Z]))([A-Z0-9])/g,"$1-$2").toLowerCase();i!==o&&Me(o,t[i])})},Me=function(t,i){var o=ve(),n=o.get(t);n===void 0?o.set(t,i):n!==i&&console.warn('[Ionicons Warning]: Multiple icons were mapped to name "'.concat(t,'". Ensure that multiple icons are not mapped to the same icon name.'))};var we=[me,ce,ue,A,V,E,T,de,ge,P,v,F,S,y,O,pe,D,N,x,B,W,R,b,L,k];var xe=(()=>{let i=class i{};i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=K({type:i}),i.\u0275inj=Y({imports:[we]});let t=i;return t})();function Se(t,i){t&1&&(r(0,"span",11),m(1,"(Ocupado)"),s())}function Te(t,i){if(t&1){let o=w();r(0,"ion-col",8),u("click",function(){let e=d(o).$implicit,a=c();return p(a.openModal(e))}),r(1,"ion-button",9),m(2),M(3,Se,2,0,"span",10),s()()}if(t&2){let o=i.$implicit,n=c();l(2),H(" ",o," HS "),l(),g("ngIf",n.isTimeSlotBooked(o))}}function ye(t,i){if(t&1){let o=w();r(0,"ion-button",25),u("click",function(){d(o);let e=c(2);return p(e.deleteAppointment())}),_(1,"ion-icon",26),m(2," Eliminar cita "),s()}}function Ae(t,i){if(t&1){let o=w();r(0,"ion-header")(1,"ion-toolbar",12)(2,"ion-title"),m(3),z(4,"date"),s(),r(5,"ion-buttons",13)(6,"ion-button",14),u("click",function(){d(o);let e=c();return p(e.closeModal())}),_(7,"ion-icon",15),s()()()(),r(8,"ion-content",1)(9,"form",16),u("ngSubmit",function(){d(o);let e=c();return p(e.saveAppointment())}),r(10,"ion-item")(11,"ion-label",17),m(12,"Nombre del cliente"),s(),r(13,"ion-input",18),I("ngModelChange",function(e){d(o);let a=c();return f(a.clientName,e)||(a.clientName=e),p(e)}),s()(),r(14,"ion-item")(15,"ion-checkbox",19),I("ngModelChange",function(e){d(o);let a=c();return f(a.paid,e)||(a.paid=e),p(e)}),m(16,"Ya pag\xF3"),s()(),r(17,"ion-item")(18,"ion-label",17),m(19,"Monto"),s(),r(20,"ion-input",20),I("ngModelChange",function(e){d(o);let a=c();return f(a.amount,e)||(a.amount=e),p(e)}),s()(),r(21,"ion-item")(22,"ion-label",17),m(23,"Observaciones"),s(),r(24,"ion-textarea",21),I("ngModelChange",function(e){d(o);let a=c();return f(a.notes,e)||(a.notes=e),p(e)}),s()(),r(25,"ion-button",22),_(26,"ion-icon",23),m(27," Guardar "),s(),M(28,ye,3,0,"ion-button",24),s()()}if(t&2){let o=c();l(3),Q(" ",G(4,7,o.selectedDate,"mediumDate")," - ",o.selectedTime," "),l(10),h("ngModel",o.clientName),l(2),h("ngModel",o.paid),l(5),h("ngModel",o.amount),l(4),h("ngModel",o.notes),l(4),g("ngIf",o.currentAppointment)}}var Ue=(()=>{let i=class i{constructor(n){this.calendarService=n,this.selectedDate=new Date().toISOString(),this.availableTimes=[],this.appointments=[],this.showToast=!1,this.toastMessage="",this.isModalOpen=!1,this.selectedTime="",this.currentAppointment=null,this.clientName="",this.paid=!1,this.amount=0,this.notes="",q({closeCircleOutline:he,saveOutline:fe,trashOutline:Ie})}ionViewWillEnter(){this.loadTimeSlotsForDate(this.selectedDate),this.loadAppointments()}loadTimeSlotsForDate(n){this.availableTimes=this.calendarService.getTimeSlotsForDate(n)}onDateSelected(n){this.selectedDate=n.detail.value,this.loadTimeSlotsForDate(this.selectedDate)}saveAppointment(){var e;let n={id:((e=this.currentAppointment)==null?void 0:e.id)||this.calendarService.generateUniqueId(),date:this.selectedDate,time:this.selectedTime,clientName:this.clientName,paid:this.paid,amount:this.amount,notes:this.notes};this.calendarService.saveAppointment(n),this.appointments=this.calendarService.getAppointments(),this.showToastMessage("Cita guardada correctamente"),this.closeModal()}loadAppointments(){this.appointments=this.calendarService.getAppointments()}isTimeSlotBooked(n){return this.appointments.some(e=>e.date===this.selectedDate&&e.time===n)}showToastMessage(n){this.toastMessage=n,this.showToast=!0,setTimeout(()=>this.showToast=!1,3e3)}openModal(n){this.selectedTime=n,this.currentAppointment=this.appointments.find(e=>e.date===this.selectedDate&&e.time===n)||null,this.currentAppointment?(this.clientName=this.currentAppointment.clientName,this.paid=this.currentAppointment.paid,this.amount=this.currentAppointment.amount,this.notes=this.currentAppointment.notes):this.resetForm(),this.isModalOpen=!0}closeModal(){this.isModalOpen=!1,this.resetForm()}resetForm(){this.clientName="",this.paid=!1,this.amount=0,this.notes=""}deleteAppointment(){this.currentAppointment&&(this.calendarService.deleteAppointment(this.currentAppointment.id),this.appointments=this.calendarService.getAppointments(),this.showToastMessage("Cita eliminada correctamente"),this.closeModal())}};i.\u0275fac=function(e){return new(e||i)(Z(Ce))},i.\u0275cmp=J({type:i,selectors:[["app-calendar"]],decls:13,vars:9,consts:[["title","Calendario - citas"],[1,"ion-padding"],["presentation","date",3,"ngModelChange","ionChange","ngModel"],[1,"time-slots-container"],[2,"text-align","center"],["size","6",3,"click",4,"ngFor","ngForOf"],[3,"didDismiss","isOpen"],["duration","3000","position","top",3,"isOpen","message"],["size","6",3,"click"],["expand","block","fill","outline",1,"time-button"],["class","booked-label",4,"ngIf"],[1,"booked-label"],["color","primary"],["slot","end"],[3,"click"],["name","close-circle-outline"],[3,"ngSubmit"],["position","floating"],["name","clientName","required","",3,"ngModelChange","ngModel"],["name","paid",3,"ngModelChange","ngModel"],["type","number","name","amount",3,"ngModelChange","ngModel"],["name","notes",3,"ngModelChange","ngModel"],["expand","block","type","submit"],["name","save-outline"],["expand","block","color","danger",3,"click",4,"ngIf"],["expand","block","color","danger",3,"click"],["name","trash-outline"]],template:function(e,a){e&1&&(_(0,"app-header",0),r(1,"ion-content",1)(2,"ion-datetime",2),I("ngModelChange",function(C){return f(a.selectedDate,C)||(a.selectedDate=C),C}),u("ionChange",function(C){return a.onDateSelected(C)}),s(),r(3,"div",3)(4,"ion-text",4),m(5),z(6,"date"),s(),r(7,"ion-grid")(8,"ion-row"),M(9,Te,4,2,"ion-col",5),s()()(),r(10,"ion-modal",6),u("didDismiss",function(){return a.closeModal()}),M(11,Ae,29,10,"ng-template"),s(),_(12,"ion-toast",7),s()),e&2&&(l(2),h("ngModel",a.selectedDate),l(3),H("Turnos disponibles para ",G(6,6,a.selectedDate,"mediumDate"),""),l(4),g("ngForOf",a.availableTimes),l(),g("isOpen",a.isModalOpen),l(2),g("isOpen",a.showToast)("message",a.toastMessage))},dependencies:[te,X,$,ee,le,re,ne,ie,se,ae,oe,xe,A,V,E,T,P,v,F,S,y,O,D,N,x,B,W,R,b,L,k,_e],styles:[".time-slots-container[_ngcontent-%COMP%]{margin-top:30px;animation:_ngcontent-%COMP%_fadeIn .5s ease-in}.time-button[_ngcontent-%COMP%]{margin:5px;--border-color: var(--ion-color-primary);--color: var(--ion-color-primary)}.time-button[_ngcontent-%COMP%]:hover{--background: var(--ion-color-primary);--color: white}.time-button[disabled][_ngcontent-%COMP%]{--background: #e0e0e0;--color: #a0a0a0;cursor:not-allowed}.booked-label[_ngcontent-%COMP%]{font-size:.8em;color:red;margin-left:5px}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}"]});let t=i;return t})();export{Ue as CalendarPage};
